<EditDataFormTemplateSpec 
    xmlns:c="bb_appfx_commontypes"
    ID="7f7f5518-193b-4509-aef9-7c111bb75530"
    Name="Child Reservation Edit Form"
    Description="Used for editing the given Child Reservation"
    Author="BETHESDA\cmayeda"
    RecordType="Child Reservation"
    DataFormInstanceID="d3e733a9-f67e-42de-88cd-0e7dcfa7c9c4"
    c:SecurityUIFolder="Child Reservation"
    OwnerIDMapperID="00000000-0000-0000-0000-000000000000"
    xmlns="bb_appfx_editdataformtemplate"
    >
    <SPDataForm>
        <LoadImplementation SPName="USP_DATAFORMTEMPLATE_EDITLOAD_CHILD_RESERVATION">
            <c:CreateProcedureSQL>
<![CDATA[
create procedure dbo.USP_DATAFORMTEMPLATE_EDITLOAD_CHILD_RESERVATION
(
    @ID uniqueidentifier,
    @DATALOADED bit = 0 output,
    @TSLONG bigint = 0 output,
    @SPONSORSHIPOPPORTUNITYCHILDID uniqueidentifier = null output,
    @SPONSORSHIPOPPORTUNITYRESERVEPROCESSID uniqueidentifier = null output,
    @SOLICITORID uniqueidentifier = null output,
    @STARTDATE datetime = null output,
    @ENDDATE datetime = null output,
    @STATUSCODE tinyint = null output
)
as

	set nocount on;

	-- be sure to set these, in case the select returns no rows
	set @DATALOADED = 0
	set @TSLONG = 0

	-- populate the output parameters, which correspond to fields on the form.  Note that
	-- we set @DATALOADED = 1 to indicate that the load was successful.  Otherwise, the system
	-- will display a "no data loaded" message.  Also note that we fetch the TSLONG so that concurrency
	-- can be considered.
	select
		@DATALOADED = 1,
		@TSLONG = TSLONG,
        @SPONSORSHIPOPPORTUNITYCHILDID = SPONSORSHIPOPPORTUNITYCHILDID, 
        @SPONSORSHIPOPPORTUNITYRESERVEPROCESSID = SPONSORSHIPOPPORTUNITYRESERVEPROCESSID, 
        @SOLICITORID = SOLICITORID, 
        @STARTDATE = STARTDATE, 
        @ENDDATE = ENDDATE, 
        @STATUSCODE = STATUSCODE
	from dbo.USR_CHILDRESERVATION
	where ID = @ID

	return 0;
]]>
</c:CreateProcedureSQL>
        </LoadImplementation>
        <SaveImplementation SPName="USP_DATAFORMTEMPLATE_EDIT_CHILD_RESERVATION">
            <c:CreateProcedureSQL>
<![CDATA[
create procedure dbo.USP_DATAFORMTEMPLATE_EDIT_CHILD_RESERVATION
(
	@ID uniqueidentifier,
	@CHANGEAGENTID uniqueidentifier = null,
    @SPONSORSHIPOPPORTUNITYCHILDID uniqueidentifier,
    @SPONSORSHIPOPPORTUNITYRESERVEPROCESSID uniqueidentifier,
    @SOLICITORID uniqueidentifier,
    @STARTDATE datetime,
    @ENDDATE datetime,
    @STATUSCODE tinyint
)
as

	set nocount on;

	if @CHANGEAGENTID is null  
		exec dbo.USP_CHANGEAGENT_GETORCREATECHANGEAGENT @CHANGEAGENTID output
						
	begin try
		-- handle updating the data
		update dbo.USR_CHILDRESERVATION set
            SPONSORSHIPOPPORTUNITYCHILDID = @SPONSORSHIPOPPORTUNITYCHILDID,
            SPONSORSHIPOPPORTUNITYRESERVEPROCESSID = @SPONSORSHIPOPPORTUNITYRESERVEPROCESSID,
            SOLICITORID = @SOLICITORID,
            STARTDATE = @STARTDATE,
            ENDDATE = @ENDDATE,
            STATUSCODE = @STATUSCODE,

			CHANGEDBYID = @CHANGEAGENTID,
			DATECHANGED = getdate()
		where ID = @ID
	end try
	begin catch
		exec dbo.USP_RAISE_ERROR
		return 1
	end catch

return 0;
]]>
</c:CreateProcedureSQL>
            <c:ExpectedDBExceptions>
                <c:Constraints>
                    <c:Constraint Name="FK_USR_CHILDRESERVATION_SPONSORSHIPOPPORTUNITYCHILDID" Field="SPONSORSHIPOPPORTUNITYCHILDID" Type="ForeignKey" />
                    <c:Constraint Name="FK_USR_CHILDRESERVATION_SPONSORSHIPOPPORTUNITYRESERVEPROCESSID" Field="SPONSORSHIPOPPORTUNITYRESERVEPROCESSID" Type="ForeignKey" />
                    <c:Constraint Name="FK_USR_CHILDRESERVATION_SOLICITORID" Field="SOLICITORID" Type="ForeignKey" />
                </c:Constraints>
            </c:ExpectedDBExceptions>
        </SaveImplementation>
    </SPDataForm>
    <c:FormMetaData FixedDialog="true">
        <c:FormFields>
            <c:FormField FieldID="SPONSORSHIPOPPORTUNITYCHILDID" DataType="Guid" Caption="Sponsorshipopportunitychild" />
            <c:FormField FieldID="SPONSORSHIPOPPORTUNITYRESERVEPROCESSID" DataType="Guid" Caption="Sponsorshipopportunityreserveprocess" />
            <c:FormField FieldID="SOLICITORID" DataType="Guid" Caption="Solicitor" />
            <c:FormField FieldID="STARTDATE" DataType="Date" Caption="Startdate" />
            <c:FormField FieldID="ENDDATE" DataType="Date" Caption="Enddate" />
            <c:FormField FieldID="STATUSCODE" DataType="TinyInt" Caption="Status" DefaultValueText="0">
                <c:ValueList>
                    <c:Items>
                        <c:Item>
                            <c:Value>0</c:Value>
                            <c:Label>Open</c:Label>
                        </c:Item>
                        <c:Item>
                            <c:Value>1</c:Value>
                            <c:Label>Closed</c:Label>
                        </c:Item>
                        <c:Item>
                            <c:Value>2</c:Value>
                            <c:Label>Sponsored</c:Label>
                        </c:Item>
                        <c:Item>
                            <c:Value>3</c:Value>
                            <c:Label>Prospect sponsored</c:Label>
                        </c:Item>
                    </c:Items>
                </c:ValueList>
            </c:FormField>
        </c:FormFields>
        <c:FormUIComponent />
    </c:FormMetaData>
</EditDataFormTemplateSpec>